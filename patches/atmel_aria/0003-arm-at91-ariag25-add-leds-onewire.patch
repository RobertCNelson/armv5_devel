From 968da67379d93b1d3467cc23a7b9721bcf8c11c8 Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Thu, 8 Nov 2012 14:23:40 -0600
Subject: [PATCH 3/3] arm at91: ariag25 add leds/onewire

Signed-off-by: Douglas Gilbert <dgilbert@interlog.com>
Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 arch/arm/boot/dts/ariag25.dts |   35 ++++++++++++++++++++++++++++-------
 1 file changed, 28 insertions(+), 7 deletions(-)

diff --git a/arch/arm/boot/dts/ariag25.dts b/arch/arm/boot/dts/ariag25.dts
index 4275317..bdde014 100644
--- a/arch/arm/boot/dts/ariag25.dts
+++ b/arch/arm/boot/dts/ariag25.dts
@@ -1,10 +1,11 @@
 /*
  * ariag25.dts - Device Tree file for Acme Systems Aria G25 (AT91SAM9G25 based)
- *
+ * Compile with dtc in <kernel_src/arch/arm/boot/dts> folder:
+ *  'dtc -O dtb -o ariag25.dtb ariag25.dts'                      [dpg 20121107]
  */
 /dts-v1/;
 /include/ "at91sam9x5.dtsi"
-/include/ "at91sam9x5cm.dtsi"
+/*   /include/ "at91sam9x5cm.dtsi"	*/
 
 / {
 	model = "Acme Systems Aria G25";
@@ -51,18 +52,20 @@
                                 compatible = "atmel,at91sam9260-usart";
                                 reg = <0xf8040000 0x200>;
                                 interrupts = <15 4 5>;
-                                status = "okay";
+                                status = "disabled";
                         };
 
 			usart5: serial@f8044000 {
                                 compatible = "atmel,at91sam9260-usart";
                                 reg = <0xf8044000 0x200>;
                                 interrupts = <16 4 5>;
-                                status = "okay";
+                                status = "disabled";
                         };
 
 			macb0: ethernet@f802c000 {
 				phy-mode = "rmii";
+		/* following can be overwritten by uboot 'ftd set' command */
+				local-mac-address = [00 04 25 dd 10 01];
 				status = "okay";
 			};
 
@@ -74,9 +77,7 @@
 				status = "okay";
 			};
 
-			i2c2: i2c@f8018000 {
-				status = "okay";
-			};
+			/* TWD2+TCLK2 hidden behind ethernet, so no i2c2 */
 
 			mmc0: mmc@f0008000 {
 				status = "okay";
@@ -91,6 +92,7 @@
 		usb0: ohci@00600000 {
 			status = "okay";
 			num-ports = <2>;
+			/* The following looks suspect */
 			atmel,vbus-gpio = <&pioD 19 1
 					   &pioD 20 1
 					  >;
@@ -100,4 +102,23 @@
 			status = "okay";
 		};
 	};
+
+	leds {
+		compatible = "gpio-leds";
+
+		/* little green LED in middle of Aria G25 module */
+                aria_led {
+                        label = "aria_led";
+                        gpios = <&pioB 8 0>;
+                        linux,default-trigger = "heartbeat";
+                };
+
+	};
+
+	onewire@0 {
+		compatible = "w1-gpio";
+
+		/* bit banging w1 at PA21 with internl pull-up */
+		gpios = <&pioA 21 1>;
+	};
 };
-- 
1.7.10.4

